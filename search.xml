<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[tiny4j:一个轻量级的类似Spring的实现]]></title>
      <url>http://twogoods.github.io/2016/12/04/tiny4j/</url>
      <content type="html"><![CDATA[<p>会点java，做点web，基本也就是spring全家桶，所以打算自己折腾一个，实现最基本最常用的一些功能。断断续续地终于完成了大部分自己想要的功能。实际项目中使用或许还不太现实，不过也提供了一个去了解框架实现的一个简单的版本，也让大家有动力有思路自己去实现一个，源码请戳<a href="https://github.com/twogoods/tiny4j" target="_blank" rel="external">github</a>。<a id="more"></a></p>
<h3 id="IOC"><a href="#IOC" class="headerlink" title="IOC"></a>IOC</h3><p>IOC很大程度借鉴了Spring,简单的使用</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"test.xml"</span>);</span><br><span class="line">ServiceBean serviceBean=(ServiceBean)applicationContext.getBean(<span class="string">"testService"</span>);</span><br><span class="line">System.<span class="keyword">out</span>.println(serviceBean);</span><br><span class="line">serviceBean.service();</span><br><span class="line"></span><br><span class="line">ServiceBean serviceBean<span class="number">2</span>=(ServiceBean)applicationContext.getBean(<span class="string">"serviceBean"</span>);</span><br><span class="line">System.<span class="keyword">out</span>.println(serviceBean<span class="number">2</span>);</span><br><span class="line">serviceBean<span class="number">2</span>.service();</span><br><span class="line"></span><br><span class="line"><span class="comment">//全局的容器上下文</span></span><br><span class="line">ApplicationContextHolder holder=applicationContext.getBean(<span class="string">"applicationContextHolder"</span>, ApplicationContextHolder.<span class="keyword">class</span>);</span><br><span class="line">System.<span class="keyword">out</span>.println(<span class="string">"holder get bean : "</span>+holder.getBean(<span class="string">"serviceBean"</span>));</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/twogoods/tiny4j/tree/master/core" target="_blank" rel="external">IOC详细说明</a></p>
<h3 id="rest"><a href="#rest" class="headerlink" title="rest"></a>rest</h3><p>实现了许多SpringMvc里高频使用的功能和一些针对restful改进的功能</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@Api</span>(<span class="string">"/base"</span>)</span><br><span class="line">public class TestController extends BaseController &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">@Value</span>(<span class="string">"$&#123;user.name:test&#125;"</span>)</span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    <span class="variable">@Inject</span></span><br><span class="line">    private UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="variable">@RequestMapping</span></span><br><span class="line">    public String index() &#123;</span><br><span class="line">        userService<span class="selector-class">.query</span>();</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">@RequestMapping</span>(mapUrl = <span class="string">"/test/&#123;id&#125;"</span>, method = HttpMethod.GET)</span><br><span class="line">    <span class="variable">@CROS</span>(origins = <span class="string">"www.baidu.com"</span>, methods = &#123;HttpMethod.GET&#125;, maxAge = <span class="string">"3600"</span>)</span><br><span class="line">    public String patgTest(<span class="variable">@PathVariable</span>(<span class="string">"id"</span>) String id) &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">@RequestMapping</span>(mapUrl = <span class="string">"/test"</span>, method = HttpMethod.GET)</span><br><span class="line">    <span class="variable">@InterceptorSelect</span>(include = &#123;<span class="string">"aInterceptor"</span>&#125;, exclude = &#123;<span class="string">"bInterceptor"</span>&#125;)</span><br><span class="line">    public String interceptorTest() &#123;</span><br><span class="line">        return "haha";</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable">@RequestMapping</span>(mapUrl = <span class="string">"/index"</span>)</span><br><span class="line">    <span class="variable">@CROS</span></span><br><span class="line">    public String paramTest(<span class="variable">@RequestParam</span>(<span class="string">"id"</span>) long id, <span class="variable">@RequestParam</span>(<span class="string">"name"</span>) String name) &#123;</span><br><span class="line">        return name + "---" + id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">@RequestMapping</span>(mapUrl = <span class="string">"/user/&#123;id&#125;"</span>, method = HttpMethod.PUT)</span><br><span class="line">    <span class="variable">@CROS</span></span><br><span class="line">    public User insert(<span class="variable">@PathVariable</span>(<span class="string">"id"</span>) long id, <span class="variable">@RequestBody</span> User user) &#123;</span><br><span class="line">        return user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看着是不是很熟悉-_- <a href="https://github.com/twogoods/tiny4j/tree/master/rest" target="_blank" rel="external">rest详细说明</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[关于动态代理]]></title>
      <url>http://twogoods.github.io/2016/11/02/proxy/</url>
      <content type="html"><![CDATA[<p>一般的程序不太会用到动态代理，在写库或者框架的时候用的多一些，我呢硬着头皮在试着完成一个类似spring的框架，过程中自然碰到了动态代理的一些小问题。  <a id="more"></a></p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@Configuration</span></span><br><span class="line">public class WebAppConfig extends WebMvcConfigurerAdapter &#123;</span><br><span class="line">    <span class="variable">@Value</span>(<span class="string">"$&#123;name&#125;"</span>)</span><br><span class="line">    private String name;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">@Bean</span></span><br><span class="line">    AuthorizeInterceptor authorizelInterceptor() &#123;</span><br><span class="line">        return new AuthorizeInterceptor(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">@Override</span></span><br><span class="line">    public void addInterceptors(InterceptorRegistry registry) &#123;</span><br><span class="line">        registry<span class="selector-class">.addInterceptor</span>(authorizelInterceptor())</span><br><span class="line">                <span class="selector-class">.addPathPatterns</span>(<span class="string">"/user/**"</span>);</span><br><span class="line">        super<span class="selector-class">.addInterceptors</span>(registry);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我是这么理解这段代码的：@Bean注解的方法里new出来的对象会仍到IOC里，下面调用了上面注解的方法会在IOC里拿出这个Bean。想改变方法的执行，首先想到的是动态代理。  </p>
<ul>
<li>JDK的动态代理，文中例子里下面这个方法addInterceptors()调用authorizelInterceptor()方法，在执行authorizelInterceptor()这个方法的时候是原模原样执行的不会再走一次代理。</li>
<li>Cglib，方法之间调用都会走代理，适合这个例子。</li>
</ul>
<p>解析<code>@Bean</code>最先想到的方法是这样：创建普通Bean一样创建实例，然后调用所有的<code>@Bean</code>注解的方法，方法得到的Bean放入IOC，最后创建一个这个类的代理对象放入IOC，也就是定义的这个Bean的实例在IOC里实际是一个代理对象。(这个方法有问题，像上面这个例子，<code>addInterceptors()</code>会调用<code>authorizelInterceptor()</code>普通对象调用的时候会创建一个<code>AuthorizeInterceptor</code>,<code>authorizelInterceptor()</code>调用的时候又会创建一个)。为解决这个问题，我们可以一开始就创建代理对象，代理对象调用方法的时候，先查看IOC里有没有这个Bean，没有就创建，有就直接返回IOC里的实例，这样就确保一个Bean只产生了一个实例。<br>我们一开始就创建一个这个类的代理对象，又发现这个类注入了一个属性值，方法里也会使用这个属性，而我在查看创建的代理对象的field时发现并没有<code>name</code>这个field，所以没办法直接设置这个值，这时只能调用<code>setter</code>即<code>setName()</code>来赋上值。然而如果我类里没有创建<code>setter</code>那就无法赋值，好在Cglib可以动态的为属性加上<code>setter</code>方法来解决这个问题。<br>最后，以上是我拿到这个问题自己的一些思考，还并没有看过Spring的实现，有时间去了解一下补上spring的实现。</p>
<hr>
<p><a href="https://github.com/twogoods/tiny4j/blob/master/core/src/test/java/com/tg/tiny4j/core/aop/CglibDynamicAopProxyTest.java" target="_blank" rel="external">代码参考</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[golang小玩具]]></title>
      <url>http://twogoods.github.io/2016/10/09/gotoys/</url>
      <content type="html"><![CDATA[<p>趁着十一假期的最后几天，写了个一直以来就想尝试的东西：命令行程序。还记得当初第一个让我非常惊艳的命令行程序<a href="https://github.com/darknessomi/musicbox" target="_blank" rel="external">网易云音乐命令行版</a>，支持快捷键，带歌词简直6的不行。毕竟程序员，平时离不开terminal，加上iTerm和Oh-My-Zsh更是让人爱不释手。<a id="more"></a>  </p>
<p>所以趁着这几天写了个简单的小玩具，会一些go所以继续用go写，实现了快递查询，天气查询的功能。天气已经实现了根据ip自动定位;快递由于要选择公司，希望接下来可以尝试利用按键来选择。</p>
<h3 id="快递查询"><a href="#快递查询" class="headerlink" title="快递查询"></a>快递查询</h3><p><img src="https://raw.githubusercontent.com/twogoods/tgToys/master/express/express.png" alt="快递查询"></p>
<h3 id="天气查询"><a href="#天气查询" class="headerlink" title="天气查询"></a>天气查询</h3><p><img src="https://raw.githubusercontent.com/twogoods/tgToys/master/weather/weather.png" alt="天气查询"><br><a href="https://github.com/twogoods/tgToys" target="_blank" rel="external">项目地址</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[最好的你们]]></title>
      <url>http://twogoods.github.io/2016/06/26/graduate/</url>
      <content type="html"><![CDATA[<p>最好的四年，遇到最好的你们。  </p>
<p>时间很快，列车也到终点站了，老司机们再不舍也得下车了~一个人闭眼冥想以前的一幕幕都很清晰的浮现在眼前，遇到一些有意思的事还能傻傻的笑，遗憾也就不遗憾了。<a id="more"></a></p>
<h3 id="618"><a href="#618" class="headerlink" title="618"></a>618</h3><p><img src="http://i2.piimg.com/4851/2ff89894a3edb1ae.jpg" alt=""></p>
<p>咱在那里算第一次相遇，某人以一个妖娆的姿势躺在床上欢迎我（我当时的第一感受，这货是哪来的→_→简直辣眼睛)。在618的日子里咱没少浪，每到周五临近周末你们又开始解放天性了不是~当然你们当中的几个懒癌患者的生活习惯哥哥实在是看不下去，到了大二分寝室，我也只能眼睁睁的看着你们生活在水深火热之中。好在分了寝室也没影响咱的交情，该扯淡扯淡，该聊段子还得接着聊，该涮的还是拿某人开涮，只是某人再也不要喝二锅头罢了…但愿你们都不带遗憾的离开。</p>
<h3 id="1203"><a href="#1203" class="headerlink" title="1203"></a>1203</h3><p><img src="http://i4.piimg.com/4851/605ce5fcad9d7ea9.jpg" alt=""></p>
<p>咱们班有五个大美女，剩下的都得管着叫爷，光好帅就俩，牛逼的班级你不服不行啊~近30个人，自然无法面面俱到，但遇到过就很好。毕业典礼那天，我把自己人生的第一次通宵奉献给了你们，我第一次看到了班级女生多愁善感的时候，姑娘间那种感情，那种舍不得看得我也有说不出的味道。今天你们中的大部分人都离开学校了，能说再见的我一定不保留，我会再呆几天，争取把你们都送走了我再走。聚是一盆火，散做满天星，天涯海角各奔东西。或许以后你们就是我只能在朋友圈里见到的面孔了，我祝福大家，同样请大家祝福我。</p>
<h3 id="51"><a href="#51" class="headerlink" title="51"></a>51</h3><p>近一年来的故事似乎都在这里了，在这里有我从来没见到过的风景，当然还有那群可爱的你们。陆陆续续的来，陆陆续续的走，这就是真实的职场节奏。我一直管自己叫傻逼程序员，然而有人说，你不像普通敲代码的，你很有趣，但愿如此吧。渐渐的你们朋友圈下的评论少了我的踪影，但一个赞就代表了全部。我和你们一样，经历了一年的实习生活，眼瞅着你们修成正果毕业工作，我却迎来了一个假期，心里有点空落落的。不眼红，沉住气，我会回来。</p>
<h3 id="zjut"><a href="#zjut" class="headerlink" title="zjut"></a>zjut</h3><p>上了大学就知道其实没那么多好与坏，四年前如果没有选择工大，或许只是故事中的人变了而已，我依旧会变得像现在的我，依旧对一切都表示不服气。大四一年很少逛工大，临走前也应该再去看看它。北上深杭，四座互联网大城市，我的下一站是魔都，我挺恋旧的，上海离杭州不远，我会常回来，看看生活了四年的地方，这一定不是我与工大的最后一张合影。  </p>
<p><img src="http://i1.piimg.com/4851/02d33ba390176de5.jpg" alt=""></p>
<h3 id="me"><a href="#me" class="headerlink" title="me"></a>me</h3><p>最终还是选择了升学，想去见识见识真正的高山。coder,engineer or scientist? no!no!no! 指不定哪天我摇身一变，额，还是一屌丝…哈哈~~ 我在上海，等大家来！</p>
<p>感谢你们，也感谢那些我从未提起的鲜为人知却又妙不可言的故事，你们就是这四年里来我最棒的体验。<br>下次再见请给我一个大大的拥抱！</p>
<blockquote>
<p>一支穿云箭，千军万马来相见<br>两副忠义胆，刀山火海提命现</p>
</blockquote>
<p>圈子不大，方寸之间，我依旧是傻逼程序员，独爱我的mac和code~</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[博客的私密空间]]></title>
      <url>http://twogoods.github.io/2016/06/15/privateblog/</url>
      <content type="html"><![CDATA[<p>很早就有了搞个博客私密空间的想法，需求来源于自己会写一些个人的感受，总结之类的东西，而这些东西我又不太希望每个人都能看到。我知道你要说，你不想让别人看到干脆就不要放博客里嘛！然而你不懂傻逼程序员在写完一篇博客之后不能放在网上嘚瑟的那种不爽的感觉。so，装X绝对是第一生产力，哈哈~  </p>
<p>一直在实习也就一直没找到时间搞这个，当然最重要的一个原因是，现在这个博客是一个利用hexo生成的静态博客，不太好改造。最终为了风格的统一，页面继续用hexo，配合着用go写了个简单的web server，趁着毕业答辩这段时间折腾了一两天，基本实现了自己想要的功能，页面的导航栏处你就能看到它。</p>
<p>微信是试水很多东西最好的地方，然而个人公众号无法申请认证…→ →我选择狗带。<br>马上就毕业了，good luck~</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[profile及配置服务]]></title>
      <url>http://twogoods.github.io/2016/04/05/profile/</url>
      <content type="html"><![CDATA[<p>一套完整的代码肯定有不同的profile，开发环境，测试环境，线上环境；程序需要读取不同的配置文件来完成不同环境的部署。传统的spring项目需要使用<code>PropertyPlaceholderConfigurer</code>来完成不同环境下的读取；springboot则特别方便，对于application.yml,application-test.yml,application-dev.yml,在启动参数里加<code>-Dspring.profiles.active=test</code>就可以按需读取，这也还是从本地的不同文件中读取，spring-cloud也提供了一个cloud-config服务，可以非常简单的实现从云端读取不同的配置文件。</p>
<h3 id="基于XML配置的spring项目"><a href="#基于XML配置的spring项目" class="headerlink" title="基于XML配置的spring项目"></a>基于XML配置的spring项目</h3><p>传统的spring项目application.xml里关于配置文件的配置，这个<code>CloudConfigLoader</code>继承<code>PropertyPlaceholderConfigurer</code>来实现按需读取<a id="more"></a><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"commonConfigurer"</span> <span class="attr">class</span>=<span class="string">"com.tg.common.configuration.CloudConfigLoader"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"locations"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>classpath*:testsettings.properties<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>classpath*:basesetting.properties<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"settingkeys"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">value</span>&gt;</span>managersetting,basesetting<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>看一下CloudConfigLoader类<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">CloudConfigLoader</span> <span class="keyword">extends</span> <span class="title">RemoteConfigLoader</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">InputStream</span> getConfigByKey(<span class="type">String</span> key) <span class="keyword">throws</span> <span class="type">Exception</span> &#123;</span><br><span class="line">        <span class="type">String</span> baseurl = <span class="type">System</span>.getProperty(<span class="string">"configurl"</span>);</span><br><span class="line">        <span class="comment">//profile:production/developer</span></span><br><span class="line">        <span class="comment">//启动加jvm参数：-Dconfigurl=xxx</span></span><br><span class="line">        <span class="comment">//-Dprofile=test(或product)</span></span><br><span class="line">        <span class="type">String</span> profile = <span class="type">System</span>.getProperty(<span class="string">"profile"</span>, <span class="string">"product"</span>);</span><br><span class="line">        <span class="type">String</span> requrl = baseurl;</span><br><span class="line">        <span class="keyword">if</span>(!baseurl.endsWith(<span class="string">"/"</span>))requrl+=<span class="string">"/"</span>;</span><br><span class="line">        requrl = requrl + key + <span class="string">"-"</span> + profile+<span class="string">".properties"</span>;</span><br><span class="line">        logger.info(<span class="string">"远程读取配置文件url："</span> + requrl);</span><br><span class="line">        <span class="type">String</span> result = callUrl(requrl,<span class="literal">null</span>,<span class="string">"GET"</span>,<span class="string">""</span>);</span><br><span class="line">        <span class="type">InputStream</span> in = <span class="keyword">new</span> <span class="type">ByteArrayInputStream</span>(result.getBytes());</span><br><span class="line">        <span class="keyword">return</span> in;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>以及RemoteConfigLoader<br><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> class RemoteConfigLoader extends PropertyPlaceholderConfigurer&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> settingkeys;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> InputStream getConfigByKey(<span class="keyword">String</span> <span class="built_in">key</span>) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="keyword">String</span> baseurl = System.getProperty(<span class="string">"configurl"</span>);</span><br><span class="line">		<span class="keyword">String</span> requrl = baseurl + <span class="string">"?key="</span> + <span class="built_in">key</span>;</span><br><span class="line">		logger.info(<span class="string">"远程读取配置文件url："</span> + requrl);</span><br><span class="line">		<span class="keyword">String</span> json = callUrl(requrl,<span class="keyword">null</span>,<span class="string">"GET"</span>,<span class="string">""</span>);</span><br><span class="line">		InputStream in = <span class="keyword">new</span> ByteArrayInputStream(json.getBytes());</span><br><span class="line">		<span class="keyword">return</span> in;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">String</span> callUrl(<span class="keyword">String</span> url, Map&lt;<span class="keyword">String</span>, <span class="keyword">String</span>&gt; <span class="built_in">map</span>,</span><br><span class="line">			<span class="keyword">String</span> method, <span class="keyword">String</span> cookie) &#123;</span><br><span class="line">		<span class="comment">//http请求读取云端文件</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> loadProperties(Properties props) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">		<span class="keyword">super</span>.loadProperties(props);</span><br><span class="line">		<span class="keyword">String</span> configurl = System.getProperty(<span class="string">"configurl"</span>);</span><br><span class="line">		<span class="keyword">if</span> (settingkeys != <span class="keyword">null</span> &amp;&amp; configurl != <span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">String</span> [] keyarr = settingkeys.<span class="built_in">split</span>(<span class="string">","</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">String</span> <span class="built_in">key</span> : keyarr)&#123;</span><br><span class="line">				InputStream in = <span class="keyword">null</span>;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					in = getConfigByKey(<span class="built_in">key</span>);</span><br><span class="line">					props.load(in);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">					logger.error(<span class="string">""</span>,e);</span><br><span class="line">				&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">					IOUtils.closeQuietly(in);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>相应的从本地读不同的配置文件,修改getConfigByKey方法<br><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> InputStream getConfigByKey(<span class="built_in">String</span> key) throws Exception &#123;</span><br><span class="line">       <span class="comment">//profile:test/product</span></span><br><span class="line">       <span class="built_in">String</span> profile = System.getProperty(<span class="string">"profile"</span>, <span class="string">"product"</span>);</span><br><span class="line">       <span class="built_in">String</span> configFile = key + <span class="string">"-"</span> + profile+<span class="string">".properties"</span>;</span><br><span class="line">       logger.info(<span class="string">"读取配置文件："</span> + configFile <span class="string">",</span><br><span class="line">               当前环境为："</span>+(<span class="string">"test"</span>.<span class="keyword">equals</span>(profile)?<span class="string">"测试"</span>:<span class="string">"生产"</span>));</span><br><span class="line">       InputStream <span class="keyword">in</span> = <span class="keyword">Thread</span>.currentThread().getContextClassLoader().</span><br><span class="line">               getResourceAsStream(configFile);</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">in</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="springboot"><a href="#springboot" class="headerlink" title="springboot"></a>springboot</h3><p>springboot中application.yml里配置不同的profiles,如下分development，production<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">    profiles:</span> development</span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">10000</span></span><br><span class="line"><span class="attr">  contextPath:</span> /demo</span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">    profiles:</span> production</span><br><span class="line"></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">  contextPath:</span> /demo</span><br></pre></td></tr></table></figure></p>
<p>或者分别配置在不同的文件中，application.yml,application-dev.yml,application-test.yml,默认使用application.yml<br>打成jar包后使用命令<code>java -jar -Dspring.profiles.active=dev 51banka.jar</code></p>
<h3 id="Spring-Cloud-Config"><a href="#Spring-Cloud-Config" class="headerlink" title="Spring Cloud Config"></a>Spring Cloud Config</h3><p>Spring Cloud Config 被设计的非常简单，几乎不需要写代码，看官方文档就可以，添加一些spring cloud的pom依赖，这个就不列出来了。<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@SpringBootApplication</span></span><br><span class="line"><span class="variable">@EnableConfigServer</span></span><br><span class="line"><span class="comment">//EnableConfigServer注解一定要加</span></span><br><span class="line">public class ConfigServiceApplication &#123;</span><br><span class="line">    <span class="selector-tag">public</span> <span class="selector-tag">static</span> <span class="selector-tag">void</span> <span class="selector-tag">main</span>(String[] args) &#123;</span><br><span class="line">        SpringApplication<span class="selector-class">.run</span>(ConfigServiceApplication.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>resource下有application.yml,bootstrap.yml;这两个的区别是bootstrap.yml里是相对不变的配置，application.yml里是可以根据cloud服务动态变的。bootstrap.yml:<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">spring:</span></span><br><span class="line"><span class="symbol">  application:</span></span><br><span class="line"><span class="symbol">    name:</span> configService</span><br><span class="line"><span class="symbol">server:</span></span><br><span class="line"><span class="symbol">  port:</span> <span class="number">9999</span></span><br></pre></td></tr></table></figure></p>
<p>而allpication.yml里的配置,使用了git服务，uri下的git仓库存放了不同的配置文件,命名规则：{application}-{profile}.yml<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">spring</span>:</span><br><span class="line">  <span class="attribute">cloud</span>:</span><br><span class="line">    <span class="attribute">config</span>:</span><br><span class="line">      <span class="attribute">server</span>:</span><br><span class="line">        <span class="attribute">git</span>:</span><br><span class="line">          <span class="attribute">uri</span>: <span class="attribute">https</span>:<span class="comment">//git.coding.net/twogoods/ConfigService.git</span></span><br><span class="line">          <span class="attribute">username</span>: xxx</span><br><span class="line">          <span class="attribute">password</span>: yyy</span><br></pre></td></tr></table></figure></p>
<p>文档里除了application和profile外还有一个lable，lable主要是一个版本信息，若使用git做服务，lable就是不同的分支<br>启动这个服务，配置服务是否成功可以通过url查看：<a href="http://localhost:9999/{application}/{profile}[/{label}" target="_blank" rel="external">http://localhost:9999/{application}/{profile}[/{label}</a>]<br>当使用这个配置服务时，可以增加配置<code>spring.cloud.config.uri: http://myconfigserver.com</code>或者启动增加jvm参数<code>-Dspring.cloud.config.profile=test -Dspring.cloud.config.uri=http://127.0.0.1:9999/</code></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[nginx]]></title>
      <url>http://twogoods.github.io/2016/03/02/nginx/</url>
      <content type="html"><![CDATA[<p>nginx可能还是运维玩的多，不过也要了解一点，有助于对程序，架构的理解。  </p>
<p>启动nginx ，sudo nginx ;访问localhost:8080 发现已出现nginx的欢迎页面了。<br>配置文件：/usr/local/etc/nginx/nginx.conf<br><a id="more"></a><br>重新加载配置|重启|停止|退出 nginx<br>nginx -s reload|reopen|stop|quit<br><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">server</span> &#123;</span><br><span class="line">        listen       <span class="number">9001</span>; 监听的端口</span><br><span class="line">        server_name  banka;</span><br><span class="line">        location / &#123;</span><br><span class="line">        	proxy_pass http:<span class="comment">//local_tomcat; 指向upstream</span></span><br><span class="line">            root   html;</span><br><span class="line">            <span class="keyword">index</span>  <span class="keyword">index</span>.html <span class="keyword">index</span>.htm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    upstream local_tomcat &#123;  <span class="comment">//配了两个服务，weight为比重</span></span><br><span class="line">	    <span class="keyword">server</span> localhost:<span class="number">8080</span> weight=<span class="number">1</span>;  </span><br><span class="line">	    <span class="keyword">server</span> localhost:<span class="number">10000</span> weight=<span class="number">1</span>;  </span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></p>
<p>多加一个服务名如mi,代理访问localhost:9000/mi/demo，实际访问的是localhost:8080/demo/。</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">9001</span>;</span><br><span class="line">    <span class="attribute">server_name</span>  banka;</span><br><span class="line">    <span class="attribute">location</span><span class="regexp"> ^~</span> /mi/ &#123;</span><br><span class="line">    	<span class="attribute">proxy_pass</span> http://localhost:8080/;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[聊一聊体育运动与新的一年]]></title>
      <url>http://twogoods.github.io/2016/02/28/2016-newyear/</url>
      <content type="html"><![CDATA[<p>过了个年，这不又长膘了，哈哈~仔细想想也好久没运动了，从7月正式实习一直到现在都没正儿八经的运动过一场，惭愧惭愧。要不是在家里，电视这种神奇的东西也是看不见的，偶尔翻开CCTV-5看看，才想起来，哟，今年是奥运年了啊。</p>
<h3 id="体育运动"><a href="#体育运动" class="headerlink" title="体育运动"></a>体育运动</h3><blockquote>
<p>体育运动是人类最伟大的发明</p>
</blockquote>
<p><a id="more"></a> 我不知道有没有前人说过这句话，如果没有那自然是最好的，我以后就可以得意的在后面属上我的名字。喜欢体育是从篮球开始的，那是06年，一晃整整10年。还记得初中高中时代特喜欢打篮球，甚至高中就敢翘一些无关紧要的课去打球，然后被班主任抓到办公室罚站，看来哥也年轻过啊，哈哈~  </p>
<p>体育运动最迷人的就是不确定性，你永远不知道下一刻会发生什么，赢家到底是谁。篮球场上的绝杀球总是激动人心的，足球场上完美的脚下技术也让人赏心悦目。多年的看球经历才让我总结出来上面这句话，而对于我们这种平凡人，时常运动健健康康的就好。前年跟好朋友去看了一场绿城跟恒大的比赛，今年我想去现场看一场篮球比赛，哪怕CBA也好。</p>
<h3 id="新的一年"><a href="#新的一年" class="headerlink" title="新的一年"></a>新的一年</h3><blockquote>
<p>有人的地方就有江湖</p>
</blockquote>
<p>最后一个学期，本科就毕业了，不出意外书还是会继续读下去。新的一年还是希望跟同学，好朋友有多一点相处的时间，毕竟有些人可能这辈子都不会再有交集了，当然也期待着接下来遇到一些更牛逼的人。有聚就会有散，聚是一盆火，散是满天星，英雄惜英雄，相忘于江湖。</p>
<h3 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h3><p>四年其实真的挺快的，转眼即逝。新的一年各位身体健康，工作学习顺利，我呢得把当初对体育运动的热情找回来，好好动动身体，锻炼锻炼，身体是革命的本钱啊。有了好身体，革命就得继续下去，人说不忘初心，那就得继续努力啊，傻逼程序员，哈哈~</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[git flow]]></title>
      <url>http://twogoods.github.io/2016/01/05/git-flow/</url>
      <content type="html"><![CDATA[<p>用过git，那么肯定要碰到gitflow，gitflow个人认为是多人协作下使用git的一个规范，完全就是git操作，不过安装git flow后特定的命令可以帮我们做很多的事情，理解可以参考阮一峰的<a href="http://www.ruanyifeng.com/blog/2012/07/git.html" target="_blank" rel="external">文章</a>。  </p>
<p>功能开发<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 初始化工作目录(一直回车即可)</span></span><br><span class="line">git flow init </span><br><span class="line"><span class="meta"># 开始创建新的需求分支(这个会从develop分出来，创建新的分支)</span></span><br><span class="line">git flow feature start editimage #这时项目会自动切换 feature/editimage分支</span><br><span class="line"><span class="meta"># 更改部分代码后</span></span><br><span class="line"><span class="meta"># git commit -a -m "修改完了"</span></span><br><span class="line"><span class="meta"># 完成开发分支合并develop(自动完成,只合并到develop，没有合并到master)</span></span><br><span class="line">git flow feature finish editimage</span><br><span class="line"><span class="meta"># 发布到远程开发分支</span></span><br><span class="line">git push origin develop</span><br></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>bug修复<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line"><span class="comment"># 切换到master分支</span></span><br><span class="line">git checkout <span class="keyword">master</span></span><br><span class="line"><span class="title"># 更新master</span>分支</span><br><span class="line">git pull origin <span class="literal">master</span>（更新<span class="literal">master</span>分支为最新） </span><br><span class="line"><span class="comment">#生成一个hotfix分支(这个从master分支上切出来，不是从develop)</span></span><br><span class="line">git flow hotfix <span class="literal">start</span> hfx     </span><br><span class="line"><span class="comment"># 最终修改完成后，结束hotfix以供发布(修改后的代码会自动合并到master和develop两个分支)</span></span><br><span class="line">git flow hotfix finish hfx</span><br><span class="line">﻿<span class="comment"># 发布最终的master分支和develop分支</span></span><br><span class="line">git push origin <span class="keyword">master</span></span><br><span class="line"><span class="title">git</span> push origin develop</span><br></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[mybatis中的几个问题]]></title>
      <url>http://twogoods.github.io/2015/12/07/mybatis/</url>
      <content type="html"><![CDATA[<p>公司里用mybatis，写着写着会有几个问题冒出来，终于有空去看了一下源代码。</p>
<ul>
<li>mybatis 方法签名返回list，LinkedList，如何实现不同的list?<br>解：单纯使用mybatis时  <code>List&lt;Object&gt; user = session.selectList(statement);</code>  只能返回list且实际为arraylist<a id="more"></a>
<code>org.apache.ibatis.executor.resultset.DefaultResultSetHandler</code>里<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">  public <span class="built_in">List</span>&lt;<span class="built_in">Object</span>&gt; handleResultSets(Statement stmt) throws SQLException &#123;</span><br><span class="line">    ErrorContext.instance().activity(<span class="string">"handling results"</span>).object(mappedStatement.getId());</span><br><span class="line">    <span class="keyword">final</span> <span class="built_in">List</span>&lt;<span class="built_in">Object</span>&gt; multipleResults = <span class="keyword">new</span> ArrayList&lt;<span class="built_in">Object</span>&gt;();</span><br><span class="line">    <span class="built_in">int</span> resultSetCount = <span class="number">0</span>;</span><br><span class="line">    ResultSetWrapper rsw = getFirstResultSet(stmt);</span><br><span class="line">    <span class="built_in">List</span>&lt;ResultMap&gt; resultMaps = mappedStatement.getResultMaps();</span><br><span class="line">    <span class="built_in">int</span> resultMapCount = resultMaps.size();</span><br><span class="line">    validateResultMapsCount(rsw, resultMapCount);</span><br><span class="line">    <span class="keyword">while</span> (rsw != <span class="keyword">null</span> &amp;&amp; resultMapCount &gt; resultSetCount) &#123;</span><br><span class="line">      ResultMap resultMap = resultMaps.<span class="keyword">get</span>(resultSetCount);</span><br><span class="line">      handleResultSet(rsw, resultMap, multipleResults, <span class="keyword">null</span>);</span><br><span class="line">      rsw = getNextResultSet(stmt);</span><br><span class="line">      cleanUpAfterHandlingResultSet();</span><br><span class="line">      resultSetCount++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">String</span>[] resultSets = mappedStatement.getResulSets();</span><br><span class="line">    <span class="keyword">if</span> (resultSets != <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">while</span> (rsw != <span class="keyword">null</span> &amp;&amp; resultSetCount &lt; resultSets.length) &#123;</span><br><span class="line">        ResultMapping parentMapping = nextResultMaps.<span class="keyword">get</span>(resultSets[resultSetCount]);</span><br><span class="line">        <span class="keyword">if</span> (parentMapping != <span class="keyword">null</span>) &#123;</span><br><span class="line">          <span class="built_in">String</span> nestedResultMapId = parentMapping.getNestedResultMapId();</span><br><span class="line">          ResultMap resultMap = configuration.getResultMap(nestedResultMapId);</span><br><span class="line">          handleResultSet(rsw, resultMap, <span class="keyword">null</span>, parentMapping);</span><br><span class="line">        &#125;</span><br><span class="line">        rsw = getNextResultSet(stmt);</span><br><span class="line">        cleanUpAfterHandlingResultSet();</span><br><span class="line">        resultSetCount++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> collapseSingleResultList(multipleResults);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>配合spring时，实际的sqlSession是一个代理，在SqlSessionTemplate能看到sqlSessionProxy这个代理类，并且代理类里有一个实现InvocationHandler的SqlSessionInterceptor。spring读取配置初始化<code>MapperFactoryBean</code>,方法执行完后对返回类型转换。<code>org.apache.ibatis.binding.MapperMethod</code> 里关于方法返回不同类型集合的转换MapperProxy的invoke方法里调mapperMethod.execute()。<br><figure class="highlight monkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line"><span class="keyword">public</span> Object invoke(Object proxy, <span class="function"><span class="keyword">Method</span> <span class="title">method</span>, <span class="title">Object</span>[] <span class="title">args</span>) <span class="title">throws</span> <span class="title">Throwable</span> &#123;</span></span><br><span class="line">  <span class="keyword">if</span> (Object.class.equals(<span class="function"><span class="keyword">method</span>.<span class="title">getDeclaringClass</span>(</span>))) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="function"><span class="keyword">method</span>.<span class="title">invoke</span>(</span>this, args);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">      <span class="keyword">throw</span> ExceptionUtil.unwrapThrowable(t);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">final</span> MapperMethod mapperMethod = cachedMapperMethod(<span class="function"><span class="keyword">method</span>);</span></span><br><span class="line">  <span class="keyword">return</span> mapperMethod.execute(sqlSession, args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">private &lt;E&gt; <span class="type">Object</span> executeForMany(<span class="type">SqlSession</span> sqlSession, <span class="type">Object</span>[] args) &#123;</span><br><span class="line">  <span class="type">List</span>&lt;E&gt; <span class="literal">result</span>;</span><br><span class="line">  <span class="type">Object</span> param = <span class="keyword">method</span>.convertArgsToSqlCommandParam(args);</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">method</span>.hasRowBounds()) &#123;</span><br><span class="line">    <span class="type">RowBounds</span> rowBounds = <span class="keyword">method</span>.extractRowBounds(args);</span><br><span class="line">    <span class="literal">result</span> = sqlSession.&lt;E&gt;selectList(command.getName(), param, rowBounds);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="literal">result</span> = sqlSession.&lt;E&gt;selectList(command.getName(), param);</span><br><span class="line">  &#125;</span><br><span class="line">  // issue <span class="comment">#510 Collections &amp; arrays support</span></span><br><span class="line">  <span class="keyword">if</span> (!<span class="keyword">method</span>.getReturnType().isAssignableFrom(<span class="literal">result</span>.getClass())) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">method</span>.getReturnType().isArray()) &#123;</span><br><span class="line">      <span class="keyword">return</span> convertToArray(<span class="literal">result</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> convertToDeclaredCollection(sqlSession.getConfiguration(), <span class="literal">result</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">result</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>resulttype为map时，map里的泛型<string,object>,<string,string>如何转化？<br>解：配置有 resultType=”java.util.Map” xml配置会组装在类 <code>MappedStatement</code> mybatis 把结果包装成<code>Map&lt;Object,Object&gt;</code></string,string></string,object></li>
</ul>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[springboot]]></title>
      <url>http://twogoods.github.io/2015/11/04/springboot/</url>
      <content type="html"><![CDATA[<p><a href="http://www.searchsoa.com.cn/2015soamicroservice/index.html" target="_blank" rel="external">关于微服务</a>及<a href="https://www.gitbook.com/book/qbgbook/spring-boot-reference-guide-zh/details" target="_blank" rel="external">中文文档</a>。这里也有一个关于微服务的<a href="http://dockone.io/article/1066" target="_blank" rel="external">系列文章</a>，写的很不错，值得一读。  </p>
<p>跟着文档可以快速的上手。springboot确实可以快速的构建一个工程，过程中遇到的一个问题就是配置文件，springboot推荐使用<code>.properities</code>或<code>yml</code>两种方式。配置文件中会分别配置测试与生产环境，如下是一个完整的配置：<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="comment">#mvn spring-boot:run 时会使用此配置</span></span><br><span class="line"><span class="attr">datasource:</span></span><br><span class="line">  <span class="number">51</span>banka:</span><br><span class="line"><span class="attr">    driverClassName:</span> com.mysql.jdbc.Driver</span><br><span class="line"><span class="attr">    url:</span> jdbc:mysql://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">3310</span>/test</span><br><span class="line">    username : root</span><br><span class="line">    password :</span><br><span class="line">    initialSize : <span class="number">10</span></span><br><span class="line">    maxActive : <span class="number">10</span></span><br><span class="line">    maxIdle : <span class="number">10</span></span><br><span class="line">    minIdle : <span class="number">10</span></span><br><span class="line"></span><br><span class="line">spring.view.prefix: /WEB-INF/jsp/</span><br><span class="line">spring.view.suffix: .jsp</span><br><span class="line"></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">10000</span></span><br><span class="line"><span class="attr">  contextPath:</span> /bankaservice</span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="comment">#测试环境的配置，打包成jar 使用 java -jar -Dspring.profiles.active=development target/test.jar 启动</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">    profiles:</span> development</span><br><span class="line"><span class="attr">datasource:</span></span><br><span class="line">  <span class="number">51</span>banka:</span><br><span class="line"><span class="attr">    driverClassName:</span> com.mysql.jdbc.Driver</span><br><span class="line"><span class="attr">    url:</span> jdbc:mysql://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">3310</span>/test</span><br><span class="line">    username : root</span><br><span class="line">    password :</span><br><span class="line">    initialSize : <span class="number">10</span></span><br><span class="line">    maxActive : <span class="number">10</span></span><br><span class="line">    maxIdle : <span class="number">10</span></span><br><span class="line">    minIdle : <span class="number">10</span></span><br><span class="line"></span><br><span class="line">spring.view.prefix: /WEB-INF/jsp/</span><br><span class="line">spring.view.suffix: .jsp</span><br><span class="line"></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">10000</span></span><br><span class="line"><span class="attr">  contextPath:</span> /test</span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="comment"># 生产环境</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">    profiles:</span> production</span><br><span class="line"><span class="attr">datasource:</span></span><br><span class="line">  <span class="number">51</span>banka:</span><br><span class="line"><span class="attr">    driverClassName:</span> com.mysql.jdbc.Driver</span><br><span class="line"><span class="attr">    url:</span> jdbc:mysql://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">3310</span>/test</span><br><span class="line">    username : root</span><br><span class="line">    password : </span><br><span class="line">    initialSize : <span class="number">30</span></span><br><span class="line">    maxActive : <span class="number">40</span></span><br><span class="line">    maxIdle : <span class="number">40</span></span><br><span class="line">    minIdle : <span class="number">30</span></span><br><span class="line"></span><br><span class="line">spring.view.prefix: /WEB-INF/jsp/</span><br><span class="line">spring.view.suffix: .jsp</span><br><span class="line"></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">  contextPath:</span> /test</span><br></pre></td></tr></table></figure></p>
<p>另文档的这一处:<br> JSP的限制<br>在内嵌的servlet容器中运行一个Spring Boot应用时（并打包成一个可执行的存档archive），容器对JSP的支持有一些限制。</p>
<ul>
<li>tomcat只支持war的打包方式，不支持可执行的jar</li>
<li>内嵌的Jetty目前不支持JSP</li>
<li>Undertow不支持JSP<br>所以为了防坑还是跳过jsp用别的模板吧</li>
</ul>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[一些整理]]></title>
      <url>http://twogoods.github.io/2015/10/17/%E5%B0%8F%E6%95%B4%E7%90%86/</url>
      <content type="html"><![CDATA[<p>看了《java并发编程实战》确实有一些可以梳理，也可以通过jdk的源码得到答案。  </p>
<ul>
<li><p>java voliate关键字与指令重排序  </p>
<p>缓存一致性问题和指令重排序的问题<a href="http://my.oschina.net/chihz/blog/58035" target="_blank" rel="external">解释1</a>,<a href="http://www.cnblogs.com/dolphin0520/p/3920373.html" target="_blank" rel="external">解释2</a></p>
</li>
<li><p>hashmap的<a href="http://www.360doc.com/content/10/0505/19/495229_26234886.shtml" target="_blank" rel="external">实现</a>，<a href="http://www.nowcoder.com/discuss/1808?type=1&amp;order=0&amp;pos=28&amp;page=0" target="_blank" rel="external">另一个</a></p>
</li>
<li><p><a href="http://ifeve.com/concurrenthashmap/" target="_blank" rel="external">concurrenthashmap的实现</a></p>
</li>
<li><a href="http://ifeve.com/java-copy-on-write/" target="_blank" rel="external">copyonwrite</a>,写时复制，读时不加锁，所以读可能是旧值，只保证最终一致性，不能保证数据的实时一致性，适合读多写少的并发场景</li>
<li>java内存泄露：<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//person 利用名字，年龄等属性重写了hashcode方法</span></span><br><span class="line">HashSet&lt;Person&gt; hs=<span class="literal">new</span> HashSet&lt;Person&gt;();</span><br><span class="line">Person p=<span class="literal">new</span> Person(<span class="string">"张三"</span>,<span class="number">25</span>);</span><br><span class="line">p.setAge(<span class="number">10</span>);</span><br><span class="line">hs.remove(p);</span><br><span class="line"><span class="comment">//这里会无法删除，修改属性后hashcode变了，也就无法找到并删除这个对象了</span></span><br><span class="line"><span class="comment">//-----或者想下面这样--------</span></span><br><span class="line"><span class="built_in">Map</span> <span class="built_in">map</span> = <span class="literal">new</span> HashMap();</span><br><span class="line"><span class="comment">//key未重写hashcode和equal方法</span></span><br><span class="line"><span class="comment">//直接这样增加的话，没有new Key()的这样引用，永远无法取出来和移除这个键值对</span></span><br><span class="line"><span class="built_in">map</span>.put(<span class="literal">new</span> Key(<span class="string">"key"</span>), <span class="string">"value"</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[一个简易的博客]]></title>
      <url>http://twogoods.github.io/2015/08/04/bolg/</url>
      <content type="html"><![CDATA[<p>很不要脸的拿了一大堆轮子造了个不像博客的博客，当然不是你现在看到的这个啦，不管怎样还是花了心思的，所以简单的说一说。<br>这东西是平常有空全凭兴趣搞的，当初主要是想弄个班级的展示页面，发现就一个页面的话也太单调了，想到给一些自定义内容的功能吧，这么一来二去就变成了这个博客。<br>说起来自己主要是搞java的，这活主要还是前端的活，但当初在学的时候一些基本的html,css,js都了解过，虽说不是举步维艰但也确实是不太熟悉。java总是跟企业级开发联系在一起，拿它写似乎也没必要，这不正好也了解过一点node拿来写写简单的逻辑还是可以的，这个博客也就算是自己学node的一个helloworld吧。  </p>
<ul>
<li><a href="http://tgblog.coding.io" target="_blank" rel="external">演示</a></li>
<li><a href="https://github.com/twogoods/tgblog" target="_blank" rel="external">代码</a></li>
</ul>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[跨域请求jsonp]]></title>
      <url>http://twogoods.github.io/2015/07/22/jsonp/</url>
      <content type="html"><![CDATA[<p>一次面试的时候被问到了跨域请求，提到了jsonp但一直没好好去看，今天再一次碰到这个，就好好的了解了一下。<br>这篇文章讲了<a href="http://www.cnblogs.com/yuzhongwusan/archive/2012/12/11/2812849.html" target="_blank" rel="external">原理</a>，而且比较容易懂,推荐一看。<br>jsonp主要是利用<code>&lt;script type=&quot;text/javascript&quot; src=&quot;scripts/jquery.min.js&quot;&gt;&lt;/script&gt;</code><br>中的src可以跨域获取数据，既然是通过script标签的src属性来请求，那么当然jsonp只有get方式的请求喽。</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[git的基本操作]]></title>
      <url>http://twogoods.github.io/2015/07/02/git/</url>
      <content type="html"><![CDATA[<ol>
<li>设置Git的user name和email：<br><code>$ git config --global user.name &quot;XXX&quot;</code><br><code>$ git config --global user.email &quot;XXX@gmail.com&quot;</code></li>
<li>键入命令：<code>ssh-keygen -t rsa -C &quot;email@email.com&quot;</code><br><code>email@email.com</code>是git账号；</li>
<li>提醒你输入key的名称，输入如<code>id_rsa</code>；</li>
<li>在用户user目录下产生两个文件：<code>id_rsa</code>和<code>id_rsa.pub</code>；</li>
<li>用打开id_rsa.pub文件，复制内容，在github.com的网站上到ssh密钥管理页面，添加新公钥，随便取个名字，内容粘贴刚才复制的内容；</li>
</ol>
<p>基本操作：<br>创建     <code>git init</code><br>添加到版本库      <code>git add readme.txt</code><br>提交到本地    <code>git commit -m &quot;fiorst commit&quot;</code><br>版本回退      <code>git reset --hard commit_id（head、head^、head~100）</code><br>查看状态     <code>git status</code><br>克隆        <code>git clone XXXXX</code><br>撤销文件的修改     <code>git checkout -- readme.txt</code><br><a id="more"></a><br>创建分支     <code>git branch &quot;name&quot;</code><br>切换分支        <code>git checkout &quot;name&quot;</code><br>创建分支+切换      <code>git checkout -b &quot;branchname&quot;</code><br>合并某分支到当前分支    <code>git merge &quot;name&quot;</code><br>删除分支        <code>git branch -d &quot;name&quot;</code><br>查看分支       <code>git branch</code><br>查看分支图    <code>git log --graph</code><br>添加远程库    <code>git remote add origin https://git……</code><br>这里也有阮大神的<a href="http://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html" target="_blank" rel="external">总结</a><br>最后，不忘出处，学git当然要看<a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/" target="_blank" rel="external">廖雪峰</a>啦。</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[redis的安装]]></title>
      <url>http://twogoods.github.io/2015/06/28/redis/</url>
      <content type="html"><![CDATA[<p>一个新东西入门总不是那样简单的，从下载，安装到完成helloworld的过程总是要花些时间的，记下来供以后参考。</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>下载肯定是去看看<a href="http://redis.io" target="_blank" rel="external">redis</a>官网啦,不过官网却并没有官方的Windows版本，提供了 Microsoft Open Tech团队的贡献的windows版本的<a href="https://github.com/MSOpenTech/redis" target="_blank" rel="external">链接</a>，可以在这里<a href="https://github.com/MSOpenTech/redis/releases" target="_blank" rel="external">下载</a>msi安装包。一些老的博客上的下载地址会指向<a href="https://github.com/dmajkic/redis" target="_blank" rel="external">这个</a>，不过已经很久没维护了，文档也说了正式的应该是上一个Open Tech团队的。</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>确定好要下载哪个后，就是安装了，msi安装文件就非常方便，直接安装并且功能添加到了系统服务中。如果是zip版本跟着文档手动的也可以很快的安装，添加服务。安装好后，命令行进入redis目录，使用命令<code>redis-server.exe redis.windows-service.conf</code>开启服务（当然添加了服务也可以去系统服务里打开），接下来就可以做一个简单的测试了<br><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">redis-cli.exe -h <span class="number">192.168</span><span class="number">.7</span><span class="number">.83</span> -p <span class="number">6379</span>  <span class="comment">//连接服务，注意IP</span></span><br><span class="line"><span class="keyword">set</span> name <span class="comment">haha</span>   //添加键值对</span><br><span class="line">get <span class="comment">name</span>        //得到键为<span class="comment">name</span>的值</span><br></pre></td></tr></table></figure></p>
<p>到这来算是把redis装好了。<br>ps:后来到公司用上了高大上的Mac，mac下安装就容易多了，直接brew安装。<br>一些基本的命令，集群的配置在这个翻译好的<a href="http://redisdoc.com/" target="_blank" rel="external">网站</a>上都有。</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Java中IO的异常处理]]></title>
      <url>http://twogoods.github.io/2015/05/08/exceptionmodel/</url>
      <content type="html"><![CDATA[<ol>
<li><p>平时都不太注意异常的处理，随意的try-catch一下，就像这样</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">10</span> / i;</span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="literal">e</span>) &#123;</span><br><span class="line">	<span class="literal">e</span>.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>真正在项目中如果就这样异常的信息只打印在了控制台，log上是没有的，一般都会这样</p>
<a id="more"></a>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">10</span> / i;</span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> ex) &#123;</span><br><span class="line">	<span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>(<span class="string">"exception"</span>);</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>try-catch后重新抛出一个异常（当然最好自己定义一个异常类，抛出自己定义的异常），一层一层抛，最后可以统一处理异常。</p>
</li>
<li>io中的异常处理：<br>在涉及java的io时会遇到各种异常的try-catch典型的写法是这样<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">InputStream input = <span class="keyword">null</span>;</span><br><span class="line">OutputStream output = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">byte</span>[] buffer=<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	input = <span class="keyword">new</span> FileInputStream(<span class="string">"XXX"</span>);</span><br><span class="line">	output = <span class="keyword">new</span> FileOutputStream(<span class="string">"YYY"</span>);</span><br><span class="line">	<span class="keyword">while</span>(input.<span class="keyword">read</span>(buffer) != -<span class="number">1</span>) &#123;</span><br><span class="line">		output.<span class="keyword">write</span>(buffer);</span><br><span class="line">	&#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> (input != <span class="keyword">null</span>) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			input.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (output != <span class="keyword">null</span>) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			output.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>由于要处理各种异常，代码变的特别丑陋，这里异常处理模板也就是<strong>模板方法</strong>的设计模式就派上用场了<br>模板1：抽象类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">InputStreamProcessingTemplate</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(String fileName)</span> </span>&#123;</span><br><span class="line">		InputStream input = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			input = <span class="keyword">new</span> FileInputStream(fileName);</span><br><span class="line">			doProcess(input);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (input != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					input.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">doProcess</span><span class="params">(InputStream input)</span></span><br><span class="line">	<span class="keyword">throws</span> IOException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>接下来如何使用<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> InputStreamProcessingTemplate()&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">doProcess</span><span class="params">(InputStream input)</span></span><br><span class="line">        <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> inChar = input.read();</span><br><span class="line">            <span class="keyword">while</span>(inChar !- <span class="number">-1</span>)&#123;</span><br><span class="line">                <span class="comment">//do something with the chars...</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;.process(<span class="string">"someFile.txt"</span>);</span><br></pre></td></tr></table></figure></p>
<p>模板2：接口方式<br>先统一声明一个处理具体业务代码的接口,流怎么使用都在这里实现<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">InputStreamProcessor</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(InputStream input)</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>处理模板<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">InputStreamProcessingTemplate2</span> &#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">process</span>(<span class="params">String fileName,</span><br><span class="line">	InputStreamProcessor processor</span>)</span>&#123;</span><br><span class="line">		InputStream input = <span class="literal">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			input = <span class="keyword">new</span> FileInputStream(fileName);</span><br><span class="line">			processor.process(input);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (input != <span class="literal">null</span>) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					input.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>具体使用传入匿名内部类<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">InputStreamProcessingTemplate2</span><span class="selector-class">.process</span>(<span class="string">"e://1.txt"</span>,</span><br><span class="line">            new InputStreamProcessor() &#123;</span><br><span class="line">			<span class="variable">@Override</span></span><br><span class="line">			public void process(InputStream input)</span><br><span class="line">			throws IOException &#123;</span><br><span class="line">				int data = input<span class="selector-class">.read</span>();</span><br><span class="line">				<span class="selector-tag">while</span> (data != -<span class="number">1</span>) &#123;</span><br><span class="line">					System<span class="selector-class">.out</span><span class="selector-class">.println</span>((char) data);</span><br><span class="line">					data = input<span class="selector-class">.read</span>();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br></pre></td></tr></table></figure></p>
<p>这样一来我们使得代码就变得比较整洁,当然java这样一来我们使得代码就变得比较整洁，当然从Java7开始，一种新的被称作“try-with-resource”的异常处理机制被引入进来，也可以像这样使用，它会确保流在使用完被正确关闭。<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">try(FileInputStream <span class="keyword">input</span> = new FileInputStream(<span class="string">"file.txt"</span>)) &#123;</span><br><span class="line">	        int data = <span class="keyword">input</span>.<span class="keyword">read</span>();</span><br><span class="line">	        <span class="keyword">while</span>(data != -1)&#123;</span><br><span class="line">	            System.<span class="keyword">out</span>.<span class="keyword">print</span>((<span class="keyword">char</span>) data);</span><br><span class="line">	            data = <span class="keyword">input</span>.<span class="keyword">read</span>();</span><br><span class="line">	        &#125;</span><br><span class="line">	    &#125; catch (IOException <span class="keyword">e</span>) &#123;</span><br><span class="line">			<span class="keyword">e</span>.printStackTrace();</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Node初步]]></title>
      <url>http://twogoods.github.io/2015/04/20/startNode/</url>
      <content type="html"><![CDATA[<p>其实node在去年就接触过了，最近想进一步接触了解一下，发现菜鸟时遇到的问题还是有必要记一下。</p>
<p>全局安装express：<br> <code>npm install -g express</code><br> express 安装好后命令行还不能使用express命令，需安装express-generato包：<br>  <code>npm install -g express-generator</code><br>  启动express：<br>  <code>npm start</code><br>  当修改代码时每次都要重启服务器会很不方便，node有一个小工具supervisor，安装后使用此工具会根据代码的改动自动重新部署。<br>  安装supervisor：<br>  <code>npm -g install supervisor</code><br>在 package.json里有这样的代码<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line"><span class="string">"start"</span>: <span class="string">"node ./bin/www"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>  所以我们可以使用如下命令来启动express：<br><code>supervisor node ./bin/www</code></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[理解java中的回调]]></title>
      <url>http://twogoods.github.io/2015/03/12/callback/</url>
      <content type="html"><![CDATA[<p>在《java编程思想》一书中时不时的提到设计模式，书中也出现了回调，在学习的时候经常听到这个词，也有必要真正去弄明白什么叫<strong>回调</strong>？<br><strong>回调</strong>用一句话解释就是，被调用方在被调用时也会调用对方。形象一点说”If you call me, i will call back”。举个生活中简单的例子：有一位老板很忙，他没有时间盯着员工干活，然后他告诉自己的雇员，干完当前这些事情后，告诉他干活的结果。<br>接下来的代码演示了这个过程：<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * 回调接口,指明用什么方式跟老板汇报，所以老板应该实现这个接口</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">CallBackInterface</span> &#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">callback</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>接下来是老板类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Boss</span> <span class="keyword">implements</span> <span class="title">CallBackInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Employee employee;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Boss</span><span class="params">(Employee employee)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.employee=employee;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//简单得实现callback</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">callback</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"老板，做完了"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//发命令让员工做事</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doaction</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//将CallBackInterface接口告诉了employee</span></span><br><span class="line">		employee.doSomeThing(<span class="keyword">this</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Employee employee=<span class="keyword">new</span> Employee();</span><br><span class="line">		Boss boss=<span class="keyword">new</span> Boss(employee);</span><br><span class="line">		boss.doaction();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>员工类，<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">public</span> <span class="selector-tag">class</span> <span class="selector-tag">Employee</span> &#123;</span><br><span class="line">	<span class="comment">//简单模拟做事的方法，做完执行回调</span></span><br><span class="line">	<span class="selector-tag">public</span> <span class="selector-tag">void</span> <span class="selector-tag">doSomeThing</span>(CallBackInterface cb)&#123;</span><br><span class="line">		System<span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="string">"干活。。"</span>);</span><br><span class="line">		System<span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="string">"干完了！"</span>);</span><br><span class="line">		cb<span class="selector-class">.callback</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>测试：<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">      Employee employee=new Employee()<span class="comment">;</span></span><br><span class="line"><span class="keyword">Boss </span><span class="keyword">boss=new </span><span class="keyword">Boss(employee);</span><br><span class="line"></span><span class="keyword">boss.doaction();</span></span><br></pre></td></tr></table></figure></p>
<p>关于回调的作用网上的这段话至少让我有了一定的认识：我们在用框架的时候，一般直接调用框架提供的API就可以了，但回调不同，当框架不能满足需求，我们想让框架来调用自己的类方法，怎么做呢？总不至于去修改框架吧。许多优秀的框架提几乎都供了相关的接口，我们只需要实现相关接口，即可完成了注册，然后在合适的时候让框架来调用我们自己的类，还记不记得我们在使用Struts时，当我们编写Action时，就需要继承Action类，然后实现execute()方法，在execute()方法中写咱们自己的业务逻辑代码，完成对用户请求的处理。由此可以猜测，框架和容器中会提供大量的回调接口，以满足个性化的定制。</p>
<p>如struts2里Action的一个代理类DefaultActionInvocation中的invoke方法<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String invoke() <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    String profileKey = <span class="string">"invoke: "</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        UtilTimerStack.<span class="keyword">push</span>(profileKey);</span><br><span class="line">        <span class="keyword">if</span> (executed) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Action has already executed"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//interceptors是包含所有拦截器的集合</span></span><br><span class="line">        <span class="keyword">if</span> (interceptors.hasNext()) &#123;</span><br><span class="line">            <span class="keyword">final</span> InterceptorMapping interceptor</span><br><span class="line">            = interceptors.<span class="keyword">next</span>();</span><br><span class="line">            String interceptorMsg = <span class="string">"interceptor: "</span> + interceptor.getName();</span><br><span class="line">            UtilTimerStack.<span class="keyword">push</span>(interceptorMsg);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">            		<span class="comment">//调用拦截器的拦截方法</span></span><br><span class="line">                    resultCode = interceptor.getInterceptor().</span><br><span class="line">                    intercept(DefaultActionInvocation.<span class="keyword">this</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">            <span class="keyword">finally</span> &#123;</span><br><span class="line">                UtilTimerStack.<span class="keyword">pop</span>(interceptorMsg);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            resultCode = invokeActionOnly();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!executed) &#123;</span><br><span class="line">        <span class="comment">//此处代码略去</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> resultCode;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        UtilTimerStack.<span class="keyword">pop</span>(profileKey);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>下面是ModelDrivenInterceptor拦截器的intercept方法<br><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">String</span> intercept(ActionInvocation invocation)</span><br><span class="line"><span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="keyword">Object</span> action = invocation.getAction();</span><br><span class="line">    <span class="keyword">if</span> (action <span class="keyword">instanceof</span> ModelDriven) &#123;</span><br><span class="line">        ModelDriven modelDriven = (ModelDriven) action;</span><br><span class="line">        ValueStack stack = invocation.getStack();</span><br><span class="line">        <span class="keyword">Object</span> model = modelDriven.getModel();</span><br><span class="line">        <span class="keyword">if</span> (model !=  <span class="keyword">null</span>) &#123;</span><br><span class="line">        	stack.push(model);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (refreshModelBeforeResult) &#123;</span><br><span class="line">            invocation.addPreResultListener(</span><br><span class="line">            <span class="keyword">new</span> RefreshModelBeforeResult(modelDriven, model));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//明显此处是回调</span></span><br><span class="line">    <span class="keyword">return</span> invocation.invoke();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这两段代码连起来看就很明确，struts2处理一个请求的时候会调用DefaultActionInvocation的invoke方法，这个方法会执行一个拦截器的intercept方法，由于调用这个方法的时候传入了invocation自身，使得拦截器里可以回调invocation的invoke的方法，也正是反复的回调使得interceptors集合里的所有拦截器都得到执行。</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[迎接新的一年]]></title>
      <url>http://twogoods.github.io/2015/03/01/chinesenewyear/</url>
      <content type="html"><![CDATA[<p>　　今天是十一，没到十五理论上年还没过完呢，不过对于我们经历了史上最长寒假的大学生来说，年已经结束了。明天是星期一，开学的第一天。<br>　　回家了20天，除了同学聚会，过年走亲访友，每天就是宅在家里。当初还发微博说要在寒假里好好学习一下angular，可惜事与愿违，家里这就不是一个可以好好学习的地方。度过了这20天的隐居生活，回到学校的第一感受就是，哇塞，我们学校好多女生啊，而且都这么漂亮，好吧，我承认已经确实没看到这么多青春靓丽的女生了，单身狗伤不起啊。。。<br>　　这两天网上最火的就是神马duang,白金还是蓝黑，别欺负我们这种眼镜党好不，分明就是白金的。好了，不瞎扯了，印象最深刻的还是昨天柴静的那个纪录片《<a href="http://v.youku.com/v_show/id_XOTAxNTUxNTI0.html" target="_blank" rel="external">穹顶之下 同呼吸共命运</a>》，发人深思，久久不能平静。</p>
<blockquote>
<p>一个人应该这么活着：春天来的时候门开着，风进来，花香进来，颜色进来；有的时候你碰到雨，或者碰到雾的时候，你会忍不住想要往肺里面，深深的呼吸一口气，能感觉到那个碎雨的那个味道，又凛冽又清新。——柴静《穹顶之下》</p>
</blockquote>
<h3 id="关于新的一年"><a href="#关于新的一年" class="headerlink" title="关于新的一年"></a>关于新的一年</h3><p>　　对于新年计划在总结里提到过了，那些就不再重复了，新年有两个棘手的问题，学车，考研。现在的我学车真是腾不出时间，又不想浪费这毕业前的这段的时间，也无非就是想在毕业前多学点，争取毕业了有底气走向社会然而爸妈又希望我读研究生，所以面临的又一个问题就是要不要考研，现在我还是给不出答案，内心还是想现在多努力，不再去参加那样一场所谓的考试。<br>　　无论如何农历新年已经过去了，又一次离家，新的一年，希望一切都好，家人身体健康。</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascript基础点]]></title>
      <url>http://twogoods.github.io/2015/02/10/2-10-JavaScript/</url>
      <content type="html"><![CDATA[<p>以下是自己学习JavaScript中遇到的问题，网上的这些博文给出了很好的解答，在此一并小计一下。<br>PS:《javascript高级程序设计》值得一读。</p>
<ol>
<li>立即执行函数(function(){…})() 与 (function(){…}()) 的区别？  <a href="http://segmentfault.com/q/1010000000442042" target="_blank" rel="external">解答</a></li>
<li><a href="http://segmentfault.com/blog/nightire/1190000000348228" target="_blank" rel="external">作用域的问题</a>  ，js里只有函数作用域：<figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">var</span> <span class="built_in">color</span>=<span class="string">"red"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params">color</span>)</span>&#123;</span><br><span class="line"><span class="comment">/*</span><br><span class="line">在函数作用域内有一个color的局部变量。</span><br><span class="line">若不是这样，alert(color)使浏览器报color is not defined的错误</span><br><span class="line">*/</span></span><br><span class="line">	alert(<span class="built_in">color</span>);</span><br><span class="line">	<span class="built_in">color</span>=<span class="string">"blue"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//这里是引用外部的全局变量</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">color</span>=<span class="string">"blue"</span>;</span><br><span class="line">&#125;</span><br><span class="line">change();<span class="comment">// undefined</span></span><br><span class="line">change(<span class="built_in">color</span>);<span class="comment">// red</span></span><br><span class="line">change2();</span><br><span class="line">alert(<span class="built_in">color</span>);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>在执行change()时声明了局部变量color但未初始化所以是undefined；执行change(color)时声明并初始化了局部变量所以是red,紧接着<code>color=&quot;blue&quot;</code>修改了局部变量的值.</p>
<ol>
<li><a href="http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html" target="_blank" rel="external">关于闭包</a>，说的通俗些闭包就是能够读取其他函数内部变量的函数。这里有进一步的<a href="https://cnodejs.org/topic/5482d05e73dcca8d21292928" target="_blank" rel="external">说明</a></li>
</ol>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[初学产品]]></title>
      <url>http://twogoods.github.io/2015/01/22/pm-start/</url>
      <content type="html"><![CDATA[<p>我也不知道我是什么时候知道产品经理这个词的，但知道了以后总是对此特别好奇，也在网上下了几本电子书看，前不久又在微博上发现了这套视频，把他分享给大家，那么就从这里开始吧。。。  </p>
<h3 id="技术人的产品修练之路-第零讲"><a href="#技术人的产品修练之路-第零讲" class="headerlink" title="技术人的产品修练之路    第零讲"></a>技术人的产品修练之路    第零讲<a id="more"></a></h3><iframe src="http://www.tudou.com/programs/view/html5embed.action?type=0&code=aZQVWpVOEvo&lcode=&resourceId=366570488_06_05_99" allowtransparency="true" allowfullscreen="true" scrolling="no" border="0" frameborder="0" style="width:480px;height:400px;"></iframe>

<h3 id="技术人的产品修练之路-第一讲"><a href="#技术人的产品修练之路-第一讲" class="headerlink" title="技术人的产品修练之路    第一讲"></a>技术人的产品修练之路    第一讲</h3><iframe src="http://www.tudou.com/programs/view/html5embed.action?type=0&code=E50GcNAKMQc&lcode=&resourceId=366570488_06_05_99" allowtransparency="true" allowfullscreen="true" scrolling="no" border="0" frameborder="0" style="width:480px;height:400px;"></iframe>


<h3 id="技术人的产品修练之路-第二讲"><a href="#技术人的产品修练之路-第二讲" class="headerlink" title="技术人的产品修练之路    第二讲"></a>技术人的产品修练之路    第二讲</h3><iframe src="http://www.tudou.com/programs/view/html5embed.action?type=0&code=2gA6cEJddOc&lcode=&resourceId=366570488_06_05_99" allowtransparency="true" allowfullscreen="true" scrolling="no" border="0" frameborder="0" style="width:480px;height:400px;"></iframe>


<h3 id="技术人的产品修练之路-第三讲"><a href="#技术人的产品修练之路-第三讲" class="headerlink" title="技术人的产品修练之路    第三讲"></a>技术人的产品修练之路    第三讲</h3><iframe src="http://www.tudou.com/programs/view/html5embed.action?type=0&code=TymeE_VVdbY&lcode=&resourceId=366570488_06_05_99" allowtransparency="true" allowfullscreen="true" scrolling="no" border="0" frameborder="0" style="width:480px;height:400px;"></iframe>]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[为父亲们点赞]]></title>
      <url>http://twogoods.github.io/2015/01/02/2015-1-2/</url>
      <content type="html"><![CDATA[<p>　　今天中午跟好朋友在去食堂的路上，他说昨天他父亲早上八点给他打电话要来看他，当时他还谁在床上呢，说是在杭州打工正好过来看看他，下午一点就走了。我就好奇问：“这么快就走了，那你们都干嘛了？”，我朋友说，“就来看了看我住的情况啊，简单聊了聊，还给我洗衣服了。”<br>　　父亲难得来一趟，看了看孩子，聊了聊家常，帮孩子洗了衣服就走了。其实我很能想象当时那个场景，因为我和我父亲又未尝没有这样的情景出现过，父子间话不多，几句天冷了多穿点衣服就是送别时的全部。你，我，大家都是一样的，习惯了母亲的唠叨，却不知父亲爱的如此深沉，父爱如山，默默的给所有父亲们点个赞。<a id="more"></a><br>　　到这来我又不禁想起前几天的一个新闻，一女学生和父亲去买手机，姑娘执意要买iPhone6，父亲表情很无奈，看这位父亲的穿着并不像特别宽裕的，但最后还是买下了。全程父女两脸上没有一丝笑容。父亲跌坐在旁边发愁，孩子你这么那么不懂事啊！  </p>
<p><img src="http://ww2.sinaimg.cn/bmiddle/af5c6f4agw1enwj5o6bgjj20c80gaabf.jpg" alt="女儿"><br><img src="http://ww3.sinaimg.cn/bmiddle/af5c6f4agw1enwj5o8u91j20c80gawfq.jpg" alt="父亲"></p>
<embed src="http://player.video.qiyi.com/a4d4c96b81346087c45b21169ecd0304/0/0/w_19rse0yl8t.swf-albumId=2988474209-tvId=2988474209-isPurchase=0-cnId=25" allowfullscreen="true" quality="high" width="480" height="350" align="middle" allowscriptaccess="always" type="application/x-shockwave-flash">]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[使用mybatis的注意点]]></title>
      <url>http://twogoods.github.io/2014/12/30/12-30-mybatis/</url>
      <content type="html"><![CDATA[<ol>
<li>像mybatis,hibernate等等框架大量用到Java的反射，千万要在你的类中定义默认的构造方法</li>
<li>想这样含多个参数的方法 <code>public String[] getUserbh(String deptbh,String banzubh);</code>配置文件中可用0,1等序号或者将参数变成 <code>Map&lt;String,Object&gt; map</code></li>
</ol>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">select</span> id=<span class="string">"getUserbh"</span> parameterType=<span class="string">"String"</span> resultType=<span class="string">"String"</span>&gt;</span><br><span class="line">   <span class="keyword">select</span> usergh <span class="keyword">from</span> people <span class="keyword">where</span> deptbh= <span class="meta">#&#123;0&#125; and banzubh= #&#123;1&#125;</span></span><br><span class="line">&lt;/<span class="keyword">select</span>&gt;</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>而这样是会报错的<br>(当然你可以用注解的方式让其准确<code>public String[] getUserbh(@Param(&quot;deptbh&quot;)String deptbh,@Param(&quot;banzubh&quot;)String banzubh);</code>)<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">select</span> id=<span class="string">"getUserbh"</span> parameterType=<span class="string">"String"</span> resultType=<span class="string">"String"</span>&gt;</span><br><span class="line">  <span class="keyword">select</span> usergh <span class="keyword">from</span> people <span class="keyword">where</span> deptbh= <span class="meta">#&#123;deptbh&#125; and banzubh= #&#123;banzubh&#125;</span></span><br><span class="line">&lt;/<span class="keyword">select</span>&gt;</span><br></pre></td></tr></table></figure></p>
<p>错误如下：<br>org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.binding.BindingException: Parameter ‘deptbh’ not found. Available parameters are [0, 1, param1, param2]　　<br>　3. mybatis中的动态SQL使用OGNL 的表达式<br><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">if</span> test="<span class="built_in">title</span> != null and <span class="built_in">title</span>!=''"&gt;</span><br><span class="line">       AND <span class="built_in">title</span> like #&#123;<span class="built_in">title</span>&#125;</span><br><span class="line">&lt;/<span class="keyword">if</span>&gt;</span><br></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[第一次尝试]]></title>
      <url>http://twogoods.github.io/2014/12/28/2014-12-28/</url>
      <content type="html"><![CDATA[<p>今天搞了一上午的博客，就弄了一点点东西。<br>这里是<a href="http://zipperary.com/" target="_blank" rel="external">教程</a>,当然更<a href="http://ijiaober.github.io/categories/hexo/" target="_blank" rel="external">详细</a>的在这。<br>hexo版本设计之后各模块都拆分出来，除了官网首页里列的一些命令：<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="keyword">install </span>hexo-cli -g</span><br><span class="line">hexo init <span class="keyword">blog</span><br><span class="line"></span>cd <span class="keyword">blog</span><br><span class="line"></span>npm <span class="keyword">install</span><br><span class="line"></span>hexo server</span><br></pre></td></tr></table></figure></p>
<p>还需<code>npm install hexo-deployer-git --save</code>安装提交到git的模块</p>
<h4 id="Markdown推荐Mweb，Quiver，作业部落这几个软件-多写就熟悉了"><a href="#Markdown推荐Mweb，Quiver，作业部落这几个软件-多写就熟悉了" class="headerlink" title="Markdown推荐Mweb，Quiver，作业部落这几个软件,多写就熟悉了"></a>Markdown推荐Mweb，Quiver，作业部落这几个软件,多写就熟悉了</h4><p><img src="http://ww2.sinaimg.cn/large/5e8cb366jw1e85r40u55hj20b40b4q2x.jpg" alt="ok。。。"></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>http://twogoods.github.io/2014/12/28/hello-world/</url>
      <content type="html"><![CDATA[<p>Welcome to my blog <a href="http://twogoods.github.io/">Twogoods</a>!</p>
<p>helloworld终于成功了！接下来就是markdown了，当然，休息会。。。</p>
]]></content>
    </entry>
    
  
  
</search>
